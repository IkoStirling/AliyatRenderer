set(MODULE_NAME sql)
set(INTERFACE_NAME ${MODULE_NAME}_xxx)


add_library(${INTERFACE_NAME} INTERFACE
)
target_include_directories(${INTERFACE_NAME} INTERFACE 
	${CMAKE_CURRENT_SOURCE_DIR}/interface
)


file(GLOB_RECURSE SRCS
	"*.cpp"
	"*."
)
add_library(${MODULE_NAME} STATIC
    ${SRCS}
)
target_include_directories(${MODULE_NAME} PUBLIC 
	${CMAKE_CURRENT_SOURCE_DIR}/include
)

# 严格来说接口库是需要方链接，这里相当于直接include了interface目录
target_link_libraries(${MODULE_NAME} PUBLIC ${INTERFACE_NAME}) 

find_package(SOCI CONFIG REQUIRED)

# CMAKE自动去重，不会链接两次
target_link_libraries(${MODULE_NAME} PUBLIC module_manager
	PRIVATE
	$<IF:$<TARGET_EXISTS:SOCI::soci_core>,SOCI::soci_core,SOCI::soci_core_static>
	$<IF:$<TARGET_EXISTS:SOCI::soci_mysql>,SOCI::soci_mysql,SOCI::soci_mysql_static>
	$<IF:$<TARGET_EXISTS:SOCI::soci_odbc>,SOCI::soci_odbc,SOCI::soci_odbc_static>
	$<IF:$<TARGET_EXISTS:SOCI::soci_postgresql>,SOCI::soci_postgresql,SOCI::soci_postgresql_static>
	$<IF:$<TARGET_EXISTS:SOCI::soci_sqlite3>,SOCI::soci_sqlite3,SOCI::soci_sqlite3_static>
) 